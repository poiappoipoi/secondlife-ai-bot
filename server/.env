# AI Provider Configuration
AI_PROVIDER=ollama

# Ollama Configuration
OLLAMA_BASE_URL=http://localhost:11434/v1
OLLAMA_MODEL=huihui_ai/qwen2.5-abliterate

# AI Settings
AI_MAX_TOKENS=300
AI_TIMEOUT_MS=30000

# Server Configuration
PORT=3002

# Rate Limiting
RATE_LIMIT_MAX=1000
RATE_LIMIT_WINDOW_MS=3600000

# Conversation
INACTIVITY_TIMEOUT_MS=3600000
CONVERSATION_MAX_HISTORY_MESSAGES=50

# Context Budget Management
CONTEXT_BUDGET_ENABLED=false
CONTEXT_MAX_TOKENS=4096
CONTEXT_SYSTEM_PROMPT_MAX_PERCENT=70

# Memory System (Keyword-Activated Memory Injection)
MEMORY_ENABLED=true
MEMORY_TOKEN_BUDGET=500

# Persona Settings
PERSONA_FILE=cat-maid.md
# PERSONAS_DIR=./personas

# Logging
LOG_TIMEZONE=UTC
LOG_LEVEL=DEBUG

# NPC State Machine (Selective Response Behavior)
# Enable/disable selective NPC behavior (responds selectively instead of to every message)
NPC_ENABLED=true

# State Machine Configuration
NPC_TICK_INTERVAL_MS=500                # How often decision cycle runs

# Timeouts (milliseconds)
NPC_LISTENING_TIMEOUT_MS=2500           # Max time to wait for decision (must be > tick interval * 4)
NPC_THINKING_TIMEOUT_MS=30000           # Max time for LLM to respond
NPC_SPEAKING_COOLDOWN_MS=5000           # Cooldown after responding

# Message Buffering
NPC_BUFFER_MAX_PER_AVATAR=10            # Max messages per avatar before oldest discarded
NPC_BUFFER_MAX_TOTAL_SIZE=50            # Max total messages across all avatars
NPC_BUFFER_AGGREGATION_WINDOW_MS=5000   # Time window for merging consecutive messages
NPC_BUFFER_EXPIRY_MS=60000              # How long to keep buffered messages

# Decision Layer - Response Thresholds
NPC_RESPONSE_THRESHOLD=50               # Min score to respond (0-100+)
NPC_RESPONSE_CHANCE=0.8                 # Probability of responding (0.0-1.0)
NPC_TRIGGER_WORDS=poi, Poi  # Words that trigger direct mention bonus

# Priority Scoring Weights
NPC_SCORE_DIRECT_MENTION=100            # Bonus for message containing trigger words
NPC_SCORE_RECENT_INTERACTION=30         # Bonus if responded to avatar in last hour
NPC_SCORE_MESSAGE_COUNT_MULT=5          # Points per buffered message
NPC_SCORE_CONSECUTIVE_BONUS=10          # Bonus per consecutive message
NPC_SCORE_MAX_TIME_DECAY=20             # Max decay from message age
NPC_SCORE_TIME_DECAY_RATE=2             # Decay per minute of age
NPC_SCORE_RANDOMNESS_RANGE=10           # Random factor (0-10) per decision

# Per-Avatar Cooldown
NPC_AVATAR_COOLDOWN_MS=2000             # Cooldown after responding to avatar (5s allows natural conversation flow)
